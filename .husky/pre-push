echo 'ğŸ—ï¸ğŸ‘· Styling, testing & building the project before pushing.'

# Ensure npm run dev is not running
if lsof -i :3000 &>/dev/null; then
    echo 'âš ï¸ Terminate localhost process (e.g., npm run dev) before pushing. âš ï¸'
    exit 1
fi


# TODO: Add testing script
# npm test || { echo 'âŒ Tests failed. Fix the issues before pushing.'; exit 1; }

# Check Prettier standards
echo 'ğŸ” Checking code format with Prettier...'
npm run check-format || {
    echo 'âŒ Styling errors â€” Prettier check failed. âŒ'
    echo 'Run npm run format, add changes, and try to push again.'
    exit 1
}

# Check ESLint standards
echo 'ğŸ” Checking code quality with ESLint...'
npm run check-lint || {
    echo 'âŒ Linting errors â€” ESLint check failed. âŒ'
    echo 'Make the required changes listed above, add changes, and try to push again.'
    exit 1
}

# Check TypeScript types
echo 'ğŸ” Checking type definitions with TypeScript...'
npm run check-types || {
    echo 'âŒ Typing errors â€” TypeScript check failed. âŒ'
    echo 'Make the above-required changes, add changes, and try to push again.'
    exit 1
}

# If linting, formatting & typing pass, proceed with build
echo 'âœ… Code is properly typed, linted & formatted âœ proceeding with build. âœ…'

npm run build || {
    echo 'âŒ Build failed. âŒ'
    echo 'View the errors above to see why.'
    exit 1
}

# Everything passes â€” time to push
echo 'ğŸ†ğŸ¥³ğŸ‰ Successful build âœ pushing changes. ğŸ‰ğŸ¥³ğŸ†'